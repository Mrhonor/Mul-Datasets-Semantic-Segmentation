{
    "model_name": "hrnet_w48_gnn",
    "aux_mode": "train",
    "n_datasets": 5,
    "hrnet": {
      "cfg": "hrnet48",
      "keep_imagenet_head": false,
      "drop_stage4": false,
      "full_res_stem": false
    },
    "GNN": {
      "model_name": "learnable_topology_BGNN",
      "nfeat": 1024,
      "nfeat_out": 512,
      "nfeat_adj": 256,
      "nhid": 64,
      "nheads": 8,
      "att_out_dim": 512,
      "output_feat_dim": 512,
      "adj_feat_dim": 128,
      "dropout_rate": 0.5,
      "unify_ratio": 0.7,
      "threshold_value": 0.95,
      "alpha": 0.2,
      "fix_architecture_alter_iter": 2000,
      "uot_ratio": 1.25,
      "calc_bipartite": false,
      "output_max_adj": true,
      "output_softmax_and_max_adj": true,
      "with_orth": true,
      "orth_weight": 10,
      "mse_or_adv": "None"
    },
    "dataset1": {
      "n_cats": 19,
      "data_reader": "CityScapes",
      "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets",
      "train_im_anns":"datasets/Cityscapes/train.txt",
      "val_im_anns":"datasets/Cityscapes/val.txt", 
      "ims_per_gpu": 2,
      "eval_ims_per_gpu": 2,
      "label_names": ["road", "sidewalk", "building", "wall", "fence", "pole", "traffic light", "traffic sign", "vegetation", "terrain", "sky", "person", "rider", "car", "truck", "bus", "train", "motorcycle", "bicycle"]
    },
    "dataset2": {
      "n_cats": 64, 
      "data_reader": "Mapiv1",
      "im_root": "/cpfs01/projects-HDD/pujianxiangmuzu_HDD/pujian/mr/datasets/mapi",
      "train_im_anns":"datasets/mapi/training.txt",
      "val_im_anns":"datasets/mapi/validation.txt", 
      "ims_per_gpu": 4,
      "eval_ims_per_gpu": 1,
      "label_names": ["Bird", "Ground Animal", "Curb", "Fence", "Guard Rail", "Barrier", "Wall", "Bike Lane", "Crosswalk - Plain", "Curb Cut", "Parking", "Pedestrian Area", "Rail Track", "Road", "Service Lane", "Sidewalk", "Bridge", "Building", "Tunnel", "Person", "Bicyclist", "Motorcyclist", "Other Rider", "Lane Marking - Crosswalk", "Lane Marking - General", "Mountain", "Sand", "Sky", "Snow", "Terrain", "Vegetation", "Water", "Banner", "Bench", "Bike Rack", "Billboard", "Catch Basin", "CCTV Camera", "Fire Hydrant", "Junction Box", "Manhole", "Phone Booth", "Pothole", "Street Light", "Pole", "Traffic Sign Frame", "Utility Pole", "Traffic Light", "Traffic Sign (Back)", "Traffic Sign (Front)", "Trash Can", "Bicycle", "Boat", "Bus", "Car", "Caravan", "Motorcycle", "On Rails", "Other Vehicle", "Trailer", "Truck", "Wheeled Slow", "Car Mount", "Ego Vehicle"]
    },
    "dataset3": {
      "n_cats": 37, 
      "data_reader": "Sunrgbd",
      "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets/",
      "train_im_anns":"datasets/sunrgbd/train.txt",
      "val_im_anns":"datasets/sunrgbd/test.txt", 
      "ims_per_gpu": 2,
      "eval_ims_per_gpu": 1,
      "label_names": [ "bag", "wall", "floor", "cabinet", "bed", "chair", "sofa", "table", "door", "window", "bookshelf", "picture", "counter", "blinds", "desk", "shelves", "curtain", "dresser", "pillow", "mirror", "floor mat", "clothes", "ceiling", "books", "refridgerator", "television", "paper", "towel", "shower curtain", "box", "whiteboard", "person", "night stand", "toilet", "sink", "lamp", "bathtub"]
    },
    "dataset4": {
      "n_cats": 26, 
      "data_reader": "Idd",
      "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets/idd",
      "train_im_anns":"datasets/IDD/train.txt",
      "val_im_anns":"datasets/IDD/val.txt", 
      "ims_per_gpu": 2,
      "eval_ims_per_gpu": 1,
      "label_names": ["road", "drivable fallback or parking", "sidewalk", "non-drivable fallback or rail track", "person or animal", "out of roi or rider", "motorcycle", "bicycle", "autorickshaw", "car", "truck", "bus", "trailer or caravan or vehicle fallback", "curb", "wall", "fence", "guard rail", "billboard", "traffic sign", "traffic light", "polegroup or pole", "obs-str-bar-fallback", "building", "tunnel or bridge", "vegetation", "sky or fallback background"]
    },
    "dataset5": {
      "n_cats": 150, 
      "data_reader": "ade2016",
      "im_root": "/cpfs01/projects-HDD/pujianxiangmuzu_HDD/pujian/mr/datasets/ade/ADEChallengeData2016",
      "train_im_anns":"datasets/ADE/training.txt",
      "val_im_anns":"datasets/ADE/validation.txt", 
      "ims_per_gpu": 8,
      "eval_ims_per_gpu": 1,
      "label_names": ["flag", "wall", "building or edifice", "sky", "floor or flooring", "tree", "ceiling", "road or route", "bed", "windowpane or window ", "grass", "cabinet", "sidewalk or pavement", "person or individual or someone or somebody or mortal or soul", "earth or ground", "door or double door", "table", "mountain or mount", "plant or flora or plant life", "curtain or drape or drapery or mantle or pall", "chair", "car or auto or automobile or machine or motorcar", "water", "painting or picture", "sofa or couch or lounge", "shelf", "house", "sea", "mirror", "rug or carpet or carpeting", "field", "armchair", "seat", "fence or fencing", "desk", "rock or stone", "wardrobe or closet or press", "lamp", "bathtub or bathing tub or bath or tub", "railing or rail", "cushion", "base or pedestal or stand", "box", "column or pillar", "signboard or sign", "chest of drawers or chest or bureau or dresser", "counter", "sand", "sink", "skyscraper", "fireplace or hearth or open fireplace", "refrigerator or icebox", "grandstand or covered stand", "path", "stairs or steps", "runway", "case or display case or showcase or vitrine", "pool table or billiard table or snooker table", "pillow", "screen door or screen", "stairway or staircase", "river", "bridge or span", "bookcase", "blind or screen", "coffee table or cocktail table", "toilet or can or commode or crapper or pot or potty or stool or throne", "flower", "book", "hill", "bench", "countertop", "stove or kitchen stove or range or kitchen range or cooking stove", "palm or palm tree", "kitchen island", "computer or computing machine or computing device or data processor or electronic computer or information processing system", "swivel chair", "boat", "bar", "arcade machine", "hovel or hut or hutch or shack or shanty", "bus or autobus or coach or charabanc or double-decker or jitney or motorbus or motorcoach or omnibus or passenger vehicle", "towel", "light or light source", "truck or motortruck", "tower", "chandelier or pendant or pendent", "awning or sunshade or sunblind", "streetlight or street lamp", "booth or cubicle or stall or kiosk", "television receiver or television or television set or tv or tv set or idiot box or boob tube or telly or goggle box", "airplane or aeroplane or plane", "dirt track", "apparel or wearing apparel or dress or clothes", "pole", "land or ground or soil", "bannister or banister or balustrade or balusters or handrail", "escalator or moving staircase or moving stairway", "ottoman or pouf or pouffe or puff or hassock", "bottle", "buffet or counter or sideboard", "poster or posting or placard or notice or bill or card", "stage", "van", "ship", "fountain", "conveyer belt or conveyor belt or conveyer or conveyor or transporter", "canopy", "washer or automatic washer or washing machine", "plaything or toy", "swimming pool or swimming bath or natatorium", "stool", "barrel or cask", "basket or handbasket", "waterfall or falls", "tent or collapsible shelter", "bag", "minibike or motorbike", "cradle", "oven", "ball", "food or solid food", "step or stair", "tank or storage tank", "trade name or brand name or brand or marque", "microwave or microwave oven", "pot or flowerpot", "animal or animate being or beast or brute or creature or fauna", "bicycle or bike or wheel or cycle ", "lake", "dishwasher or dish washer or dishwashing machine", "screen or silver screen or projection screen", "blanket or cover", "sculpture", "hood or exhaust hood", "sconce", "vase", "traffic light or traffic signal or stoplight", "tray", "ashcan or trash can or garbage can or wastebin or ash bin or ash-bin or ashbin or dustbin or trash barrel or trash bin", "fan", "pier or wharf or wharfage or dock", "crt screen", "plate", "monitor or monitoring device", "bulletin board or notice board", "shower", "radiator", "glass or drinking glass", "clock"]
    },
    "n_bn": 1,
    "class_remaper": "ClassRemapOneHotLabel",
    "loss":{
      "type": "Adv_GNN",
      "reweight": false,
      "with_aux": false,
      "with_unify_label": true,
      "aux_weight": 1,
      "aux_num": 4,
      "ignore_index": 255,
      "domain_loss_weight": 1,
      "m": 0,
      "gamma": 12,
      "with_spa": true,
      "spa_loss_weight": 0.1,
      "with_max_enc": false,
      "max_enc_weight": 1,
      "adv_loss_weight": 1
    },
    "use_ema": false,
    "lr": {
      "lr_start": 5e-3,
      "weight_decay": 1e-5,
      "warmup_iters": 5000,
      "fix_param_iters": 0,
      "max_iter": 240000,
      "init_iter": 0
    },
    "train": {
      "scales": [0.5, 2.0],
      "cropsize": [713, 713],
      "finetune": true,
      "finetune_from": "res/clip/7_dataset_model_final.pth",
      "graph_finetune": false,
      "graph_finetune_from": "res/celoss/graph_model_40000.pth",
      "seg_iters": 20000,
      "gnn_iters": 20000,
      "finetune_stage1_iters": 80000,
      "finetune_stage2_iters": 120000,
      "joint_train": true
    },
    "val": {
      "scales": [0.5, 0.75, 1.0, 1.25, 1.5, 1.75],
      "cropsize": [512, 512]
    },
    "use_fp16": false,
    "use_sync_bn": true,
    "contrast": {
      "use_contrast": true,
      "proj_dim": 512,
      "temperature": 0.07,
      "base_temperature": 0.07,
      "max_samples": 4096,
      "max_views": 24,
      "loss_weight": 1,
      "num_prototype": 1,
      "coefficient": 0.999,
      "upsample": false,
      "downsample": false,
      "update_confidence_thresh": 0.1,
      "update_sim_thresh": 0.4,
      "with_ppd": false,
      "ppd_loss_weight": 1,
      "with_hard_lb_contrast": false,
      "hard_lb_contrast_loss_weight": 1,
      "with_consistence": false,
      "consistent_loss_weight": 10,
      "with_mulbn": false,
      "memory_bank": false,
      "memory_bank_size": 5000
    },
    "res_save_pth": "res/celoss/",
    "network": {
      "stride": 4,
      "with_domain_adversarial": false,
      "bn_type": "torchbn"
    },
    "dataset_aux_head": {
      "use_dataset_aux_head": false,
      "aux_iter": 15000
    },
    "optim": "AdamW",
    "iter": 0
}
