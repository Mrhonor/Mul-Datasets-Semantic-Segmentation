{
  "model_name": "hrnet_w48_gnn",
  "aux_mode": "train",
  "n_datasets": 7,
  "hrnet": {
    "cfg": "hrnet48",
    "keep_imagenet_head": false,
    "drop_stage4": false,
    "full_res_stem": false
  },
  "GNN": {
    "model_name": "learnable_topology_BGNN",
    "nfeat": 1024,
    "nfeat_out": 512,
    "nfeat_adj": 256,
    "nhid": 64,
    "nheads": 8,
    "att_out_dim": 512,
    "output_feat_dim": 512,
    "adj_feat_dim": 128,
    "dropout_rate": 0.5,
    "unify_ratio": 0.8,
    "threshold_value": 0.95,
    "alpha": 0.2,
    "fix_architecture_alter_iter": 0,
    "uot_ratio": 1.25,
    "GNN_type": "GSAGE",
    "calc_bipartite": false,
    "output_max_adj": true,
    "output_softmax_and_max_adj": true,
    "with_orth": true,
    "orth_weight": 10,
    "mse_or_adv": "None",
    "ema_graph": false,
    "ema_graph_rate": 0.999    
  },
  "dataset1": {
    "n_cats": 19,
    "data_reader": "CityScapes",
    "im_root": "/home1/marong/datasets",
    "train_im_anns":"datasets/Cityscapes/train.txt",
    "val_im_anns":"datasets/Cityscapes/val.txt", 
    "ims_per_gpu": 1,
    "eval_ims_per_gpu": 1,
    "label_names": ["road", "sidewalk", "building", "wall", "fence", "pole", "traffic light", "traffic sign", "vegetation", "terrain", "sky", "person", "rider", "car", "truck", "bus", "train", "motorcycle", "bicycle"]
  },
  "dataset2": {
    "n_cats": 43, 
    "data_reader": "Mapiv1_mseg",
    "im_root": "/home1/marong/datasets/mapi",
    "train_im_anns":"datasets/mapi/training.txt",
    "val_im_anns":"datasets/mapi/validation.txt", 
    "ims_per_gpu": 1,
    "eval_ims_per_gpu": 1,
    "label_names": ["bird", "dog", "tunnel", "bridge", "building", "trash_can", "railroad", "road", "snow", "sidewalk_pavement", "terrain", "person", "rider_other", "bicyclist", "motorcyclist", "streetlight", "road_barrier", "wall", "cctv_camera", "junction_box", "traffic_sign", "traffic_light", "fire_hydrant", "bench", "bike_rack", "billboard", "sky", "pole", "fence", "guard_rail", "mountain_hill", "banner", "vegetation", "bicycle", "car", "motorcycle", "bus", "train", "truck", "trailer", "boat_ship", "slow_wheeled_object", "water_other"]
  },
  "dataset3": {
    "n_cats": 37, 
    "data_reader": "Sunrgbd",
    "im_root": "/home1/marong/datasets/",
    "train_im_anns":"datasets/sunrgbd/train.txt",
    "val_im_anns":"datasets/sunrgbd/test.txt", 
    "ims_per_gpu": 1,
    "eval_ims_per_gpu": 1,
    "label_names": [ "bag", "wall", "floor", "cabinet", "bed", "chair", "sofa", "table", "door", "window", "bookshelf", "picture", "counter", "blinds", "desk", "shelves", "curtain", "dresser", "pillow", "mirror", "floor mat", "clothes", "ceiling", "books", "refridgerator", "television", "paper", "towel", "shower curtain", "box", "whiteboard", "person", "night stand", "toilet", "sink", "lamp", "bathtub"]
  },
  "dataset4": {
    "n_cats": 19, 
    "data_reader": "Bdd100k",
    "im_root": "/home1/marong/datasets/bdd100k",
    "train_im_anns":"datasets/bdd100k/train.txt",
    "val_im_anns":"datasets/bdd100k/val.txt", 
    "ims_per_gpu": 1,
    "eval_ims_per_gpu": 1,
    "label_names": ["road", "sidewalk", "building", "wall", "fence", "pole", "traffic light", "traffic sign", "vegetation", "terrain", "sky", "person", "rider", "car", "truck", "bus", "train", "motorcycle", "bicycle"]
  },
  "dataset5": {
    "n_cats": 26, 
    "data_reader": "Idd",
    "im_root": "/home1/marong/datasets/idd",
    "train_im_anns":"datasets/IDD/train.txt",
    "val_im_anns":"datasets/IDD/val.txt", 
    "ims_per_gpu": 1,
    "eval_ims_per_gpu": 1,
    "label_names": ["road", "drivable fallback or parking", "sidewalk", "non-drivable fallback or rail track", "person or animal", "out of roi or rider", "motorcycle", "bicycle", "autorickshaw", "car", "truck", "bus", "trailer or caravan or vehicle fallback", "curb", "wall", "fence", "guard rail", "billboard", "traffic sign", "traffic light", "polegroup or pole", "obs-str-bar-fallback", "building", "tunnel or bridge", "vegetation", "sky or fallback background"]
  },
  "dataset6": {
    "n_cats": 117, 
    "data_reader": "ade2016_mseg",
    "im_root": "/home1/marong/datasets/ADEChallengeData2016",
    "train_im_anns":"datasets/ADE/training.txt",
    "val_im_anns":"datasets/ADE/validation.txt", 
    "ims_per_gpu": 1,
    "eval_ims_per_gpu": 1,
    "label_names": ["bag", "case", "animal", "microwave", "radiator", "oven", "storage_tank", "conveyor_belt", "sink", "refrigerator", "washer_dryer", "fan", "dishwasher", "toilet", "bathtub", "shower", "bridge", "pier_wharf", "tent", "building", "ceiling", "television", "floor", "stage", "food_other", "chair_other", "armchair", "swivel_chair", "stool", "seat", "couch", "trash_can", "potted_plant", "bed", "table", "pool_table", "barrel", "desk", "ottoman", "wardrobe", "crib", "basket", "chest_of_drawers", "bookshelf", "counter_other", "bathroom_counter", "kitchen_island", "door", "light_other", "lamp", "sconce", "chandelier", "mirror", "shelf", "stairs", "escalator", "cabinet", "fireplace", "stove", "arcade_machine", "road", "sidewalk_pavement", "runway", "terrain", "book", "box", "clock", "vase", "plaything_other", "painting", "poster", "bulletin_board", "bottle", "wine_glass", "tray", "range_hood", "plate", "person", "streetlight", "traffic_light", "bench", "billboard", "sky", "pole", "fence", "railing_banister", "mountain_hill", "rock", "sports_ball", "base", "sculpture", "column", "fountain", "awning", "apparel", "flag", "blanket", "curtain_other", "pillow", "towel", "rug_floormat", "vegetation", "bicycle", "car", "motorcycle", "airplane", "bus", "truck", "boat_ship", "river_lake", "sea", "water_other", "swimming_pool", "waterfall", "wall", "window", "window_blind"]
  },
  "dataset7": {
    "n_cats": 122, 
    "data_reader": "Coco_data_mseg",
    "im_root": "/home1/marong/datasets/coco",
    "train_im_anns":"datasets/coco/train.txt",
    "val_im_anns":"datasets/coco/val.txt", 
    "ims_per_gpu": 1,
    "eval_ims_per_gpu": 1,
    "label_names": ["backpack", "umbrella", "bag", "tie", "suitcase", "bird", "cat", "dog", "horse", "sheep", "cow", "elephant", "bear", "zebra", "giraffe", "microwave", "oven", "toaster", "sink", "refrigerator", "toilet", "bridge", "tent", "building", "ceiling", "laptop", "keyboard", "mouse", "remote", "cell phone", "television", "floor", "banana", "apple", "sandwich", "orange", "broccoli", "carrot", "hot_dog", "pizza", "donut", "cake", "fruit_other", "food_other", "chair_other", "couch", "potted_plant", "bed", "table", "counter_other", "door", "light_other", "mirror", "shelf", "stairs", "cabinet", "gravel", "platform", "playingfield", "railroad", "road", "snow", "sidewalk_pavement", "terrain", "book", "box", "clock", "vase", "scissors", "teddy_bear", "hair_dryer", "toothbrush", "bottle", "cup", "wine_glass", "knife", "fork", "spoon", "bowl", "person", "paper", "traffic_sign", "traffic_light", "fire_hydrant", "parking_meter", "bench", "sky", "fence", "mountain_hill", "rock", "frisbee", "skis", "snowboard", "sports_ball", "kite", "baseball_bat", "baseball_glove", "skateboard", "surfboard", "tennis_racket", "net", "banner", "blanket", "curtain_other", "pillow", "towel", "rug_floormat", "vegetation", "bicycle", "car", "motorcycle", "airplane", "bus", "train", "truck", "boat_ship", "river_lake", "sea", "water_other", "wall", "window", "window_blind"]
  },
  "n_bn": 1,
  "class_remaper": "ClassRemapOneHotLabel",
  "loss":{
    "type": "Adv_GNN",
    "reweight": false,
    "with_aux": false,
    "with_unify_label": true,
    "aux_weight": 1,
    "aux_num": 4,
    "ignore_index": 255,
    "domain_loss_weight": 1,
    "m": 0,
    "gamma": 12,
    "with_spa": true,
    "spa_loss_weight": 0.1,
    "with_max_enc": false,
    "max_enc_weight": 1,
    "adv_loss_weight": 1
  },
  "use_ema": false,
  "lr": {
    "lr_start":5e-4,
    "gnn_lr_start": 5e-4,
    "seg_lr_start": 1e-3,
    "weight_decay": 1e-5,
    "warmup_iters": 1000,
    "fix_param_iters": 0,
    "max_iter": 400000,
    "init_iter": 0
  },
  "train": {
    "scales": [0.5, 1.0, 2.0],
    "cropsize": [713, 713],
    "finetune": true,
    "finetune_from": "res/celoss/seg_model_130000.pth",
    "graph_finetune": true,
    "graph_finetune_from": "res/celoss/graph_model_130000.pth",
    "seg_iters": 100000,
    "gnn_iters": 100000,
    "finetune_stage1_iters": 30000,
    "finetune_stage2_iters": 80000,
    "joint_train": true
  },
  "val": {
    "scales": [0.5, 0.75, 1.0, 1.25, 1.5, 1.75],
    "cropsize": [512, 512]
  },
  "use_fp16": false,
  "use_sync_bn": true,
  "contrast": {
    "use_contrast": true,
    "proj_dim": 512,
    "temperature": 0.07,
    "base_temperature": 0.07,
    "max_samples": 4096,
    "max_views": 24,
    "loss_weight": 1,
    "num_prototype": 1,
    "coefficient": 0.999,
    "upsample": false,
    "downsample": false,
    "update_confidence_thresh": 0.1,
    "update_sim_thresh": 0.4,
    "with_ppd": false,
    "ppd_loss_weight": 1,
    "with_hard_lb_contrast": false,
    "hard_lb_contrast_loss_weight": 1,
    "with_consistence": false,
    "consistent_loss_weight": 10,
    "with_mulbn": false,
    "memory_bank": false,
    "memory_bank_size": 5000
  },
  "res_save_pth": "res/celoss/",
  "network": {
    "stride": 4,
    "with_domain_adversarial": false,
    "bn_type": "torchbn"
  },
  "dataset_aux_head": {
    "use_dataset_aux_head": false,
    "aux_iter": 15000
  },
  "optim": "AdamW",
  "iter": 0
}
