{
  "model_name": "hrnet_w48",
  "aux_mode": "train",
  "n_datasets": 1,
  "hrnet": {
    "cfg": "hrnet48",
    "keep_imagenet_head": false,
    "drop_stage4": false,
    "full_res_stem": false
  },
  "GNN": {
    "model_name": "learnable_topology_BGNN",
    "nfeat": 1024,
    "nfeat_out": 512,
    "nfeat_adj": 256,
    "nhid": 64,
    "nheads": 8,
    "att_out_dim": 512,
    "output_feat_dim": 512,
    "adj_feat_dim": 128,
    "dropout_rate": 0.5,
    "unify_ratio": 0.7,
    "threshold_value": 0.95,
    "alpha": 0.2,
    "fix_architecture_alter_iter": 2000,
    "uot_ratio": 1.0,
    "calc_bipartite": false,
    "output_max_adj": false,
    "output_softmax_and_max_adj": true,
    "with_orth": false,
    "orth_weight": 10,
    "mse_or_adv": "None"
  },
  "dataset1": {
    "n_cats": 19,
    "data_reader": "CityScapes",
    "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets",
    "train_im_anns":"datasets/Cityscapes/train.txt",
    "val_im_anns":"datasets/Cityscapes/val.txt", 
    "ims_per_gpu": 2,
    "eval_ims_per_gpu": 2,
    "label_names": ["road", "sidewalk", "building", "wall", "fence", "pole", "traffic light", "traffic sign", "vegetation", "terrain", "sky", "person", "rider", "car", "truck", "bus", "train", "motorcycle", "bicycle"]
  },
  "n_bn": 1,
  "class_remaper": "ClassRemapOneHotLabel",
  "loss":{
    "type": "Adv_GNN",
    "reweight": false,
    "with_aux": false,
    "with_unify_label": true,
    "aux_weight": 1,
    "aux_num": 4,
    "ignore_index": 255,
    "domain_loss_weight": 1,
    "m": 0,
    "gamma": 12,
    "with_spa": true,
    "spa_loss_weight": 0.1,
    "with_max_enc": false,
    "max_enc_weight": 1,
    "adv_loss_weight": 1
  },
  "use_ema": false,
  "lr": {
    "lr_start": 1e-2,
    "weight_decay": 1e-5,
    "warmup_iters": 5000,
    "fix_param_iters": 0,
    "max_iter": 125000,
    "init_iter": 0
  },
  "train": {
    "scales": [0.5, 1.0, 2.0],
    "cropsize": [713, 713],
    "finetune": false,
    "finetune_from": "res/clip/7_dataset_model_final.pth",
    "graph_finetune": false,
    "graph_finetune_from": "res/celoss/graph_model_60000.pth",
    "seg_iters": 90000,
    "gnn_iters": 100000,
    "finetune_stage1_iters": 30000,
    "finetune_stage2_iters": 60000,
    "joint_train": true
  },
  "val": {
    "scales": [0.5, 0.75, 1.0, 1.25, 1.5, 1.75],
    "cropsize": [512, 512]
  },
  "use_fp16": false,
  "use_sync_bn": false,
  "contrast": {
    "use_contrast": true,
    "proj_dim": 512,
    "temperature": 0.07,
    "base_temperature": 0.07,
    "max_samples": 4096,
    "max_views": 24,
    "loss_weight": 1,
    "num_prototype": 1,
    "coefficient": 0.999,
    "upsample": false,
    "downsample": false,
    "update_confidence_thresh": 0.1,
    "update_sim_thresh": 0.4,
    "with_ppd": false,
    "ppd_loss_weight": 1,
    "with_hard_lb_contrast": false,
    "hard_lb_contrast_loss_weight": 1,
    "with_consistence": false,
    "consistent_loss_weight": 10,
    "with_mulbn": false,
    "memory_bank": false,
    "memory_bank_size": 5000
  },
  "res_save_pth": "res/clip/",
  "network": {
    "stride": 4,
    "with_domain_adversarial": false,
    "bn_type": "torchbn"
  },
  "dataset_aux_head": {
    "use_dataset_aux_head": false,
    "aux_iter": 15000
  },
  "optim": "AdamW",
  "iter": 0
}
