{
    "model_name": "hrnet_w48_gnn",
    "aux_mode": "train",
    "n_datasets": 2,
    "hrnet": {
      "cfg": "hrnet48",
      "keep_imagenet_head": false,
      "drop_stage4": false,
      "full_res_stem": false
    },
    "GNN": {
      "model_name": "learnable_topology_BGNN",
      "nfeat": 1024,
      "nfeat_out": 512,
      "nfeat_adj": 256,
      "nhid": 64,
      "nheads": 8,
      "att_out_dim": 512,
      "output_feat_dim": 256,
      "adj_feat_dim": 128,
      "dropout_rate": 0.5,
      "unify_ratio": 1,
      "threshold_value": 0.95,
      "alpha": 0.2,
      "fix_architecture_alter_iter": 2000,
      "calc_bipartite": false,
      "output_max_adj": true,
      "output_softmax_and_max_adj": true
    },
    "dataset1": {
      "n_cats": 19,
      "data_reader": "CityScapes",
      "im_root": "/home/mr/datasets",
      "train_im_anns":"datasets/Cityscapes/train.txt",
      "val_im_anns":"datasets/Cityscapes/val.txt", 
      "ims_per_gpu": 1,
      "eval_ims_per_gpu": 1,
      "label_names": ["road", "sidewalk", "building", "wall", "fence", "pole", "traffic light", "traffic sign", "vegetation", "terrain", "sky", "person", "rider", "car", "truck", "bus", "train", "motorcycle", "bicycle"]
    },
    "dataset2": {
      "n_cats": 36, 
      "data_reader": "A2D2Data",
      "im_root": "/home/mr/datasets/a2d2",
      "train_im_anns":"datasets/A2D2/train.txt",
      "val_im_anns":"datasets/A2D2/val.txt", 
      "ims_per_gpu": 1,
      "eval_ims_per_gpu": 1,
      "label_names": ["Car", "Bicycle", "Pedestrian", "Truck", "Small vehicles", "Traffic signal", "traffic sign", "Utility vehicle", "Sidebars", "Speed bumper", "Curbstone", "Solid line", "Irrelevant signs", "Road blocks", "Tractor", "Non-drivable street", "Zebra crossing", "Obstacles / trash", "Poles", "RD restricted area", "Animals", "Grid structure", "Signal corpus", "Drivable cobblestone", "Electronic traffic", "Slow drive area", "Nature object", "Parking area", "Sidewalk", "Ego car", "Painted driv. instr.", "Traffic guide obj.", "Dash line", "RD normal street", "Sky", "Buildings"]
    },
    "dataset3": {
      "n_cats": 37, 
      "data_reader": "Sunrgbd",
      "im_root": "/home/mr/datasets/",
      "train_im_anns":"datasets/sunrgbd/train.txt",
      "val_im_anns":"datasets/sunrgbd/test.txt", 
      "ims_per_gpu": 1,
      "eval_ims_per_gpu": 1,
      "label_names": [ "bag", "wall", "floor", "cabinet", "bed", "chair", "sofa", "table", "door", "window", "bookshelf", "picture", "counter", "blinds", "desk", "shelves", "curtain", "dresser", "pillow", "mirror", "floor mat", "clothes", "ceiling", "books", "refridgerator", "television", "paper", "towel", "shower curtain", "box", "whiteboard", "person", "night stand", "toilet", "sink", "lamp", "bathtub"]
    },
    "dataset4": {
      "n_cats": 19, 
      "data_reader": "Bdd100k",
      "im_root": "/home/mr/datasets/bdd100k",
      "train_im_anns":"datasets/bdd100k/train.txt",
      "val_im_anns":"datasets/bdd100k/val.txt", 
      "ims_per_gpu": 1,
      "eval_ims_per_gpu": 1,
      "label_names": ["road", "sidewalk", "building", "wall", "fence", "pole", "traffic light", "traffic sign", "vegetation", "terrain", "sky", "person", "rider", "car", "truck", "bus", "train", "motorcycle", "bicycle"]
    },
    "dataset5": {
      "n_cats": 88, 
      "data_reader": "Mapi",
      "im_root": "/home/mr/datasets/mapi",
      "train_im_anns":"datasets/mapi/training.txt",
      "val_im_anns":"datasets/mapi/validation.txt", 
      "ims_per_gpu": 1,
      "eval_ims_per_gpu": 1,
      "label_names": ["Bird", "Ground Animal", "Curb", "Fence", "Guard Rail", "Barrier", "Road Median", "Road Side", "Temporary Barrier", "Wall", "Bike Lane", "Crosswalk - Plain", "Driveway", "Parking", "Parking Aisle", "Pedestrian Area", "Rail Track", "Road", "Service Lane", "Sidewalk", "Traffic Island", "Bridge", "Building", "Garage", "Tunnel", "Person Group", "Bicyclist", "Motorcyclist", "Other Rider", "Lane Marking - Ambiguous", "Lane Marking - Arrow (Other)", "Lane Marking - Arrow (Right)", "Lane Marking - Arrow (Split Right or Straight)", "Lane Marking - Arrow (Straight)", "Lane Marking - Give Way (Row)", "Lane Marking - Give Way (Single)", "Lane Marking - Hatched (Diagonal)", "Lane Marking - Text", "Lane Marking (only) - Test", "Mountain", "Sand", "Sky", "Snow", "Terrain", "Vegetation", "Water", "Banner", "Bench", "Bike Rack", "Catch Basin", "CCTV Camera", "Fire Hydrant", "Junction Box", "Manhole", "Parking Meter", "Phone Booth", "Pothole", "Signage - Back", "Signage - Information", "Signage - Other", "Signage - Store", "Street Light", "Pole Group", "Traffic Sign Frame", "Utility Pole", "Traffic Cone", "Traffic Light - Other", "Traffic Sign - Parking", "Traffic Sign - Temporary (Back)", "Traffic Sign - Temporary (Front)", "Trash Can", "Bicycle", "Boat", "Bus", "Caravan", "Motorcycle", "On Rails", "Other Vehicle", "Trailer", "Truck", "Vehicle Group", "Wheeled Slow", "Water Valve", "Car Mount", "Dynamic", "Ego Vehicle", "Ground", "Static"]
    },
    "dataset6": {
      "n_cats": 133, 
      "data_reader": "Coco_data",
      "im_root": "/home/mr/datasets/coco",
      "train_im_anns":"datasets/coco/train.txt",
      "val_im_anns":"datasets/coco/val.txt", 
      "ims_per_gpu": 1,
      "eval_ims_per_gpu": 1,
      "label_names": ["rug-merged", "person", "bicycle", "car", "motorcycle", "airplane", "bus", "train", "truck", "boat", "traffic light", "fire hydrant", "stop sign", "parking meter", "bench", "bird", "cat", "dog", "horse", "sheep", "cow", "elephant", "bear", "zebra", "giraffe", "backpack", "umbrella", "handbag", "tie", "suitcase", "frisbee", "skis", "snowboard", "sports ball", "kite", "baseball bat", "baseball glove", "skateboard", "surfboard", "tennis racket", "bottle", "wine glass", "cup", "fork", "knife", "spoon", "bowl", "banana", "apple", "sandwich", "orange", "broccoli", "carrot", "hot dog", "pizza", "donut", "cake", "chair", "couch", "potted plant", "bed", "dining table", "toilet", "tv", "laptop", "mouse", "remote", "keyboard", "cell phone", "microwave", "oven", "toaster", "sink", "refrigerator", "book", "clock", "vase", "scissors", "teddy bear", "hair drier", "toothbrush", "banner", "blanket", "bridge", "cardboard", "counter", "curtain", "door-stuff", "floor-wood", "flower", "fruit", "gravel", "house", "light", "mirror-stuff", "net", "pillow", "platform", "playingfield", "railroad", "river", "road", "roof", "sand", "sea", "shelf", "snow", "stairs", "tent", "towel", "wall-brick", "wall-stone", "wall-tile", "wall-wood", "water-other", "window-blind", "window-other", "tree-merged", "fence-merged", "ceiling-merged", "sky-other-merged", "cabinet-merged", "table-merged", "floor-other-merged", "pavement-merged", "mountain-merged", "grass-merged", "dirt-merged", "paper-merged", "food-other-merged", "building-other-merged", "rock-merged", "wall-other-merged"]
    },
    "dataset7": {
      "n_cats": 37, 
      "data_reader": "Idd",
      "im_root": "/home/mr/datasets/idd",
      "train_im_anns":"datasets/IDD/train.txt",
      "val_im_anns":"datasets/IDD/val.txt", 
      "ims_per_gpu": 1,
      "eval_ims_per_gpu": 1,
      "label_names": ["person", "truck", "fence", "billboard", "bus", "out of roi", "curb", "obs-str-bar-fallback", "tunnel", "non-drivable fallback", "bridge", "road", "wall", "traffic sign", "trailer", "animal", "building", "sky", "drivable fallback", "guard rail", "bicycle", "traffic light", "polegroup", "motorcycle", "car", "parking", "fallback background", "rectification border", "train", "rider", "rail track", "sidewalk", "caravan", "pole", "vegetation", "autorickshaw", "vehicle fallback"]
    },

    "n_bn": 1,
    "class_remaper": "ClassRemapOneHotLabel",
    "loss":{
      "type": "Adv_GNN",
      "reweight": false,
      "with_aux": false,
      "with_unify_label": true,
      "aux_weight": 1,
      "aux_num": 4,
      "ignore_index": 255,
      "domain_loss_weight": 1,
      "m": 0,
      "gamma": 12,
      "with_spa": true,
      "spa_loss_weight": 0.1,
      "with_max_enc": true,
      "max_enc_weight": 1,
      "adv_loss_weight": 1
    },
    "use_ema": false,
    "lr": {
      "lr_start": 5e-3,
      "weight_decay": 5e-5,
      "warmup_iters": 1000,
      "fix_param_iters": 0,
      "max_iter": 400000
    },
    "train": {
      "scales": [0.5, 1.0, 2.0],
      "cropsize": [512, 512],
      "finetune": true,
      "finetune_from": "res/celoss/pretrain_seg_model.pth",
      "graph_finetune": false,
      "graph_finetune_from": "res/celoss/pretrain_graph_model.pth",
      "seg_iters": 20000,
      "gnn_iters": 10000,
      "joint_train": true
    },
    "val": {
      "scales": [0.5, 0.75, 1.0, 1.25, 1.5, 1.75],
      "cropsize": [512, 512]
    },
    "use_fp16": false,
    "use_sync_bn": true,
    "contrast": {
      "use_contrast": true,
      "proj_dim": 512,
      "temperature": 0.07,
      "base_temperature": 0.07,
      "max_samples": 4096,
      "max_views": 24,
      "loss_weight": 1,
      "num_prototype": 1,
      "coefficient": 0.999,
      "upsample": false,
      "downsample": false,
      "update_confidence_thresh": 0.1,
      "update_sim_thresh": 0.4,
      "with_ppd": false,
      "ppd_loss_weight": 1,
      "with_hard_lb_contrast": false,
      "hard_lb_contrast_loss_weight": 1,
      "with_consistence": false,
      "consistent_loss_weight": 10,
      "with_mulbn": false,
      "memory_bank": false,
      "memory_bank_size": 5000
    },
    "res_save_pth": "res/celoss/",
    "network": {
      "stride": 4,
      "with_domain_adversarial": false,
      "bn_type": "torchbn"
    },
    "dataset_aux_head": {
      "use_dataset_aux_head": false,
      "aux_iter": 15000
    },
    "optim": "AdamW",
    "iter": 0
}
