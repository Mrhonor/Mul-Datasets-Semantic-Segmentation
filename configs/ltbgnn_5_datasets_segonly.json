{
    "model_name": "hrnet_w48_gnn",
    "aux_mode": "train",
    "n_datasets": 5,
    "hrnet": {
      "cfg": "hrnet48",
      "keep_imagenet_head": false,
      "drop_stage4": false,
      "full_res_stem": false
    },
    "GNN": {
      "model_name": "learnable_topology_BGNN",
      "nfeat": 1024,
      "nfeat_out": 512,
      "nfeat_adj": 256,
      "nhid": 64,
      "nheads": 8,
      "att_out_dim": 512,
      "output_feat_dim": 512,
      "adj_feat_dim": 128,
      "dropout_rate": 0.5,
      "unify_ratio": 1,
      "threshold_value": 0.95,
      "alpha": 0.2,
      "fix_architecture_alter_iter": 2000,
      "calc_bipartite": false,
      "output_max_adj": false,
      "output_softmax_and_max_adj": true
    },
    "dataset1": {
      "n_cats": 19,
      "data_reader": "CityScapes",
      "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets",
      "train_im_anns":"datasets/Cityscapes/train.txt",
      "val_im_anns":"datasets/Cityscapes/val.txt", 
      "ims_per_gpu": 4,
      "eval_ims_per_gpu": 2,
      "label_names": ["road", "sidewalk", "building", "wall", "fence", "pole", "traffic light", "traffic sign", "vegetation", "terrain", "sky", "person", "rider", "car", "truck", "bus", "train", "motorcycle", "bicycle"]
    },
    "dataset2": {
      "n_cats": 12, 
      "data_reader": "CamVid",
      "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets/CamVid",
      "train_im_anns":"datasets/CamVid/train.txt",
      "val_im_anns":"datasets/CamVid/test.txt", 
      "ims_per_gpu": 4,
      "eval_ims_per_gpu": 2,
      "label_names": ["Sky", "Building", "Column_Pole", "Road", "Sidewalk", "Tree", "SignSymbol", "Fence", "Car", "Pedestrian", "Bicyclist", "Wall"]
    },
    "dataset3": {
      "n_cats": 37, 
      "data_reader": "Sunrgbd",
      "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets/",
      "train_im_anns":"datasets/sunrgbd/train.txt",
      "val_im_anns":"datasets/sunrgbd/test.txt", 
      "ims_per_gpu": 4,
      "eval_ims_per_gpu": 1,
      "label_names": [ "bag", "wall", "floor", "cabinet", "bed", "chair", "sofa", "table", "door", "window", "bookshelf", "picture", "counter", "blinds", "desk", "shelves", "curtain", "dresser", "pillow", "mirror", "floor mat", "clothes", "ceiling", "books", "refridgerator", "television", "paper", "towel", "shower curtain", "box", "whiteboard", "person", "night stand", "toilet", "sink", "lamp", "bathtub"]
    },
    "dataset4": {
      "n_cats": 19, 
      "data_reader": "Bdd100k",
      "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets/bdd100k",
      "train_im_anns":"datasets/bdd100k/train.txt",
      "val_im_anns":"datasets/bdd100k/val.txt", 
      "ims_per_gpu": 4,
      "eval_ims_per_gpu": 2,
      "label_names": ["road", "sidewalk", "building", "wall", "fence", "pole", "traffic light", "traffic sign", "vegetation", "terrain", "sky", "person", "rider", "car", "truck", "bus", "train", "motorcycle", "bicycle"]
    },
    "dataset5": {
      "n_cats": 37, 
      "data_reader": "Idd",
      "im_root": "/cpfs01/projects-SSD/pujianxiangmuzu_SSD/pujian/mr/datasets/idd",
      "train_im_anns":"datasets/IDD/train.txt",
      "val_im_anns":"datasets/IDD/val.txt", 
      "ims_per_gpu": 4,
      "eval_ims_per_gpu": 1,
      "label_names": ["person", "truck", "fence", "billboard", "bus", "out of roi", "curb", "obs-str-bar-fallback", "tunnel", "non-drivable fallback", "bridge", "road", "wall", "traffic sign", "trailer", "animal", "building", "sky", "drivable fallback", "guard rail", "bicycle", "traffic light", "polegroup", "motorcycle", "car", "parking", "fallback background", "rectification border", "train", "rider", "rail track", "sidewalk", "caravan", "pole", "vegetation", "autorickshaw", "vehicle fallback"]
    },
    "n_bn": 1,
    "class_remaper": "ClassRemapOneHotLabel",
    "loss":{
      "type": "Adv_GNN",
      "reweight": false,
      "with_aux": false,
      "with_unify_label": true,
      "aux_weight": 1,
      "aux_num": 4,
      "ignore_index": 255,
      "domain_loss_weight": 1,
      "m": 0,
      "gamma": 12,
      "with_spa": true,
      "spa_loss_weight": 0.1,
      "with_max_enc": true,
      "max_enc_weight": 1,
      "adv_loss_weight": 1
    },
    "use_ema": false,
    "lr": {
      "lr_start": 5e-4,
      "weight_decay": 1e-5,
      "warmup_iters": 1000,
      "fix_param_iters": 0,
      "max_iter": 80000
    },
    "train": {
      "scales": [0.5, 1.0, 2.0],
      "cropsize": [512, 1024],
      "finetune": true,
      "finetune_from": "res/celoss/seg_model_final.pth",
      "graph_finetune": true,
      "graph_finetune_from": "res/celoss/gnn_model_final.pth",
      "seg_iters": 80000,
      "gnn_iters": 20000,
      "joint_train": true
    },
    "val": {
      "scales": [0.5, 0.75, 1.0, 1.25, 1.5, 1.75],
      "cropsize": [512, 512]
    },
    "use_fp16": false,
    "use_sync_bn": false,
    "contrast": {
      "use_contrast": true,
      "proj_dim": 512,
      "temperature": 0.07,
      "base_temperature": 0.07,
      "max_samples": 4096,
      "max_views": 24,
      "loss_weight": 1,
      "num_prototype": 1,
      "coefficient": 0.999,
      "upsample": false,
      "downsample": false,
      "update_confidence_thresh": 0.1,
      "update_sim_thresh": 0.4,
      "with_ppd": false,
      "ppd_loss_weight": 1,
      "with_hard_lb_contrast": false,
      "hard_lb_contrast_loss_weight": 1,
      "with_consistence": false,
      "consistent_loss_weight": 10,
      "with_mulbn": false,
      "memory_bank": false,
      "memory_bank_size": 5000
    },
    "res_save_pth": "res/celoss/",
    "network": {
      "stride": 4,
      "with_domain_adversarial": false,
      "bn_type": "torchbn"
    },
    "dataset_aux_head": {
      "use_dataset_aux_head": false,
      "aux_iter": 15000
    },
    "optim": "AdamW",
    "iter": 0
}
